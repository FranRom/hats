import React, { useState } from "react";
import "../../styles/Vulnerability/ContactInfo.scss";
import { AccordionContext } from "./VulnerabilityAccordion";
//import axios from "axios";

interface IProps {
  data: {
    username: string
  }
}

export default function ContactInfo(props: IProps) {
  const [username, setUsername] = useState(props.data.username);
  //const [loading, setLoading] = useState(false);
  //const [error, setError] = useState(false);
  const { submitCard } = React.useContext(AccordionContext);

  // const verifyContact = async () => {
  //   setLoading(true);
  //   try {
  //     // TODO: change to Telegram API
  //     const data = await axios.get(`https://keybase.io/_/api/1.0/user/lookup.json?username=${username}`);
  //     setLoading(false);
  //     if (data.data.status.code === 0) {
  //       setError(false);
  //       submitCard(3, { username: username });
  //     } else {
  //       setError(true);
  //     }
  //   } catch (err) {
  //     setLoading(false);
  //     console.log(err);
  //   }
  // }

  // onClick={verifyContact}

  return <div className="contact-info-wrapper card-content">
    <div><span className="arrow-text">{`-->`}</span>Add your Telegram user</div>
    <div><span className="arrow-text">{`-->`}</span>You will be updated via your Telegram user in the submition progress</div>
    <div className="add-contact-data">
      <input autoFocus type="text" placeholder="Your Telegram username" value={username} onChange={(e) => setUsername(e.target.value)} />
      <button disabled={username === ""} onClick={() => submitCard(2, { username: username })}>ADD</button>
    </div>
    {/* {error && <span className="error">Telegram username not found!</span>} */}
  </div>
}
